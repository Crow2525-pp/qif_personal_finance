{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {
          "type": "grafana",
          "uid": "-- Grafana --"
        },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": null,
  "links": [],
  "liveNow": false,
  "panels": [
    {
      "datasource": {
        "type": "postgres",
        "uid": "PCC52D03280B7034C"
      },
      "description": "Data recency for the current dashboard context.",
      "fieldConfig": {
        "defaults": {
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "x": 0,
        "y": 0,
        "w": 6,
        "h": 3
      },
      "id": 101,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "PCC52D03280B7034C"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "WITH available_months AS (\n  SELECT budget_year_month,\n         to_date(budget_year_month || '-01', 'YYYY-MM-DD') AS month_date\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE budget_year_month < TO_CHAR(CURRENT_DATE, 'YYYY-MM')\n),\nlatest_period AS (\n  SELECT MAX(month_date) AS month_date\n  FROM available_months\n),\nselected_period AS (\n  SELECT CASE\n           WHEN '${dashboard_period}' = 'Latest' OR coalesce('${dashboard_period}', '') = ''\n             THEN (SELECT month_date FROM latest_period)\n           ELSE to_date('${dashboard_period}' || '-01', 'YYYY-MM-DD')\n         END AS month_date\n),\nselected_key AS (\n  SELECT to_char(month_date, 'YYYY-MM') AS month_key\n  FROM selected_period\n),\nwindow_range AS (\n  SELECT\n    CASE '${time_window}'\n      WHEN 'ytd'          THEN DATE_TRUNC('year', (SELECT month_date FROM selected_period))\n      WHEN 'trailing_12m' THEN (SELECT month_date FROM selected_period) - INTERVAL '11 months'\n      ELSE                     (SELECT month_date FROM selected_period)\n    END AS start_date,\n    (SELECT month_date FROM selected_period) AS end_date\n),\nexec_view AS (\n  SELECT dashboard_generated_at\n  FROM reporting.rpt_executive_dashboard\n  WHERE dashboard_month = (SELECT month_key FROM selected_key)\n)\nSELECT\n  CASE '${time_window}'\n    WHEN 'ytd'          THEN 'Year to Date'\n    WHEN 'trailing_12m' THEN 'Trailing 12 Months'\n    ELSE                     'Latest Month'\n  END AS \"Time Window\",\n  CASE '${time_window}'\n    WHEN 'ytd'          THEN to_char((SELECT start_date FROM window_range), 'Mon YYYY') || ' \u2013 ' || to_char((SELECT end_date FROM window_range), 'Mon YYYY')\n    WHEN 'trailing_12m' THEN to_char((SELECT start_date FROM window_range), 'Mon YYYY') || ' \u2013 ' || to_char((SELECT end_date FROM window_range), 'Mon YYYY')\n    ELSE                     to_char((SELECT end_date FROM window_range), 'Mon YYYY')\n  END AS \"Data Through\",\n  to_char(MAX(exec_view.dashboard_generated_at), 'YYYY-MM-DD HH24:MI') AS \"Last Refresh\"\nFROM exec_view;",
          "refId": "A"
        }
      ],
      "title": "Data Freshness",
      "type": "table"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "PCC52D03280B7034C"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "x": 6,
        "y": 0,
        "w": 18,
        "h": 3
      },
      "id": 20,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": false
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "PCC52D03280B7034C"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "WITH available_months AS (\n  SELECT budget_year_month,\n         to_date(budget_year_month || '-01', 'YYYY-MM-DD') AS month_date\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE budget_year_month < TO_CHAR(CURRENT_DATE, 'YYYY-MM')\n),\nlatest_period AS (\n  SELECT MAX(month_date) AS month_date\n  FROM available_months\n),\nselected_period AS (\n  SELECT CASE\n           WHEN '${dashboard_period}' = 'Latest' OR coalesce('${dashboard_period}', '') = ''\n             THEN (SELECT month_date FROM latest_period)\n           ELSE to_date('${dashboard_period}' || '-01', 'YYYY-MM-DD')\n         END AS month_date\n),\nselected_key AS (\n  SELECT to_char(month_date, 'YYYY-MM') AS month_key\n  FROM selected_period\n),\nwindow_range AS (\n  SELECT\n    CASE '${time_window}'\n      WHEN 'ytd'          THEN DATE_TRUNC('year', (SELECT month_date FROM selected_period))\n      WHEN 'trailing_12m' THEN (SELECT month_date FROM selected_period) - INTERVAL '11 months'\n      ELSE                     (SELECT month_date FROM selected_period)\n    END AS start_date,\n    (SELECT month_date FROM selected_period) AS end_date\n),\nwindow_budget AS (\n  SELECT\n    COALESCE(SUM(net_cash_flow), 0) AS total_net_cash_flow,\n    COALESCE(SUM(total_income), 0)  AS total_income\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD')\n        BETWEEN (SELECT start_date FROM window_range)\n        AND     (SELECT end_date   FROM window_range)\n),\ncurrent_cf AS (\n  SELECT forecasted_next_month_net_flow\n  FROM reporting.rpt_cash_flow_analysis\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD') = (SELECT end_date FROM window_range)\n),\nsummary AS (\n  SELECT\n    CASE '${time_window}'\n      WHEN 'ytd'          THEN 'YTD through ' || to_char((SELECT end_date FROM window_range), 'Mon YYYY')\n      WHEN 'trailing_12m' THEN 'Trailing 12M through ' || to_char((SELECT end_date FROM window_range), 'Mon YYYY')\n      ELSE                     to_char((SELECT end_date FROM window_range), 'Mon YYYY')\n    END AS period_label,\n    CASE WHEN wb.total_net_cash_flow >= 0 THEN 'Positive' ELSE 'Negative' END AS health_rating,\n    COALESCE(ccf.forecasted_next_month_net_flow, 0) AS forecast_value\n  FROM window_budget wb\n  LEFT JOIN current_cf ccf ON TRUE\n)\nSELECT CONCAT('\ud83d\udcca Financial Summary for ', summary.period_label,\n              ' | Net Cash Flow: ', summary.health_rating,\n              ' | Next Month Forecast: $', ROUND(summary.forecast_value)::text) AS summary\nFROM summary;",
          "refId": "A"
        }
      ],
      "title": "Executive Summary",
      "type": "table"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "PCC52D03280B7034C"
      },
      "description": "Overall financial health scoreboard. Each bar reflects raw ratios from the selected month: savings performance is net cash flow \u00c3\u00b7 income, cash-flow status comes from the cash-flow analysis state machine, and net-worth progress tracks the wealth milestone. The composite score weights net worth 30%, savings 30%, and cash flow 40%.",
      "fieldConfig": {
        "defaults": {
          "min": 0,
          "max": 100,
          "unit": "short",
          "links": [
            {
              "title": "View Savings Analysis Details",
              "url": "/d/savings_analysis",
              "targetBlank": true
            },
            {
              "title": "View Net Worth Dashboard",
              "url": "/d/household_net_worth",
              "targetBlank": true
            },
            {
              "title": "View Account Performance",
              "url": "/d/account_performance_dashboard",
              "targetBlank": true
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": 0
              },
              {
                "color": "yellow",
                "value": 50
              },
              {
                "color": "green",
                "value": 70
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Financial Health"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "#32CD32",
                  "mode": "fixed"
                }
              },
              {
                "id": "displayName",
                "value": "Financial Health"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Savings Performance"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "#FFD700",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Net Worth Progress"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "#FF6347",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Cash Flow Status"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "#1E90FF",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "x": 0,
        "y": 3,
        "w": 12,
        "h": 5
      },
      "id": 6,
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "horizontal",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": true
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "PCC52D03280B7034C"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "WITH available_months AS (\n  SELECT budget_year_month,\n         to_date(budget_year_month || '-01', 'YYYY-MM-DD') AS month_date\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE budget_year_month < TO_CHAR(CURRENT_DATE, 'YYYY-MM')\n),\nlatest_period AS (\n  SELECT MAX(month_date) AS month_date\n  FROM available_months\n),\nselected_period AS (\n  SELECT CASE\n           WHEN '${dashboard_period}' = 'Latest' OR coalesce('${dashboard_period}', '') = ''\n             THEN (SELECT month_date FROM latest_period)\n           ELSE to_date('${dashboard_period}' || '-01', 'YYYY-MM-DD')\n         END AS month_date\n),\nselected_key AS (\n  SELECT to_char(month_date, 'YYYY-MM') AS month_key\n  FROM selected_period\n),\nwindow_range AS (\n  SELECT\n    CASE '${time_window}'\n      WHEN 'ytd'          THEN DATE_TRUNC('year', (SELECT month_date FROM selected_period))\n      WHEN 'trailing_12m' THEN (SELECT month_date FROM selected_period) - INTERVAL '11 months'\n      ELSE                     (SELECT month_date FROM selected_period)\n    END AS start_date,\n    (SELECT month_date FROM selected_period) AS end_date\n),\nwindow_budget AS (\n  SELECT\n    COALESCE(SUM(net_cash_flow), 0) AS total_net_cash_flow,\n    COALESCE(SUM(total_income), 0)  AS total_income\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD')\n        BETWEEN (SELECT start_date FROM window_range)\n        AND     (SELECT end_date   FROM window_range)\n),\ncurrent_cf AS (\n  SELECT cash_flow_status\n  FROM reporting.rpt_cash_flow_analysis\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD') = (SELECT end_date FROM window_range)\n),\ncurrent_nw AS (\n  SELECT wealth_milestone\n  FROM reporting.rpt_household_net_worth\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD') = (SELECT end_date FROM window_range)\n),\nscores AS (\n  SELECT\n    CASE\n      WHEN NULLIF(wb.total_income, 0) IS NULL THEN 10\n      WHEN wb.total_net_cash_flow / wb.total_income >= 0.30 THEN 100\n      WHEN wb.total_net_cash_flow / wb.total_income >= 0.20 THEN 80\n      WHEN wb.total_net_cash_flow / wb.total_income >= 0.15 THEN 60\n      WHEN wb.total_net_cash_flow / wb.total_income >= 0.10 THEN 40\n      WHEN wb.total_net_cash_flow / wb.total_income >= 0.05 THEN 25\n      ELSE 10\n    END AS savings_score,\n    CASE coalesce(cnw.wealth_milestone, '')\n      WHEN 'High Net Worth'    THEN 100\n      WHEN 'Building Wealth'   THEN 80\n      WHEN 'Positive Net Worth' THEN 60\n      WHEN 'Rebuilding Phase'  THEN 40\n      WHEN 'Starting Out'      THEN 25\n      ELSE 40\n    END AS net_worth_score,\n    CASE coalesce(ccf.cash_flow_status, '')\n      WHEN 'Strong Positive' THEN 100\n      WHEN 'Positive'        THEN 80\n      WHEN 'Neutral'         THEN 60\n      WHEN 'Negative'        THEN 40\n      WHEN 'Critical'        THEN 20\n      ELSE 40\n    END AS cash_flow_score\n  FROM window_budget wb\n  LEFT JOIN current_cf ccf ON TRUE\n  LEFT JOIN current_nw cnw ON TRUE\n),\ncombined AS (\n  SELECT\n    ROUND(0.3 * COALESCE(net_worth_score, 0) + 0.3 * COALESCE(savings_score, 0) + 0.4 * COALESCE(cash_flow_score, 0)) AS financial_health,\n    savings_score,\n    net_worth_score,\n    cash_flow_score\n  FROM scores\n)\nSELECT financial_health AS \"Financial Health\",\n       savings_score AS \"Savings Performance\",\n       net_worth_score AS \"Net Worth Progress\",\n       cash_flow_score AS \"Cash Flow Status\"\nFROM combined;",
          "refId": "A"
        }
      ],
      "title": "Financial Health Scores",
      "transformations": [],
      "type": "bargauge"
    },
    {
      "id": 11,
      "title": "Key Executive KPIs",
      "type": "table",
      "datasource": {
        "type": "postgres",
        "uid": "PCC52D03280B7034C"
      },
      "gridPos": {
        "x": 12,
        "y": 3,
        "w": 12,
        "h": 5
      },
      "options": {
        "cellHeight": "sm",
        "showHeader": true
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "left"
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "metric"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Metric"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "current_value"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Current ($)"
              },
              {
                "id": "unit",
                "value": "currencyUSD"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "previous_value"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Previous ($)"
              },
              {
                "id": "unit",
                "value": "currencyUSD"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "delta_value"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "\u00ce\u201d ($)"
              },
              {
                "id": "unit",
                "value": "currencyUSD"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "delta_ratio"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "\u00ce\u201d Ratio"
              },
              {
                "id": "unit",
                "value": "percentunit"
              }
            ]
          }
        ]
      },
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "PCC52D03280B7034C"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "WITH available_months AS (\n  SELECT budget_year_month,\n         to_date(budget_year_month || '-01', 'YYYY-MM-DD') AS month_date\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE budget_year_month < TO_CHAR(CURRENT_DATE, 'YYYY-MM')\n),\nlatest_period AS (\n  SELECT MAX(month_date) AS month_date\n  FROM available_months\n),\nselected_period AS (\n  SELECT CASE\n           WHEN '${dashboard_period}' = 'Latest' OR coalesce('${dashboard_period}', '') = ''\n             THEN (SELECT month_date FROM latest_period)\n           ELSE to_date('${dashboard_period}' || '-01', 'YYYY-MM-DD')\n         END AS month_date\n),\nwindow_range AS (\n  SELECT\n    CASE '${time_window}'\n      WHEN 'ytd'          THEN DATE_TRUNC('year', (SELECT month_date FROM selected_period))\n      WHEN 'trailing_12m' THEN (SELECT month_date FROM selected_period) - INTERVAL '11 months'\n      ELSE                     (SELECT month_date FROM selected_period)\n    END AS start_date,\n    (SELECT month_date FROM selected_period) AS end_date\n),\nprevious_window_range AS (\n  SELECT\n    CASE '${time_window}'\n      WHEN 'ytd'          THEN DATE_TRUNC('year', (SELECT month_date FROM selected_period)) - INTERVAL '1 year'\n      WHEN 'trailing_12m' THEN (SELECT month_date FROM selected_period) - INTERVAL '23 months'\n      ELSE                     (SELECT month_date FROM selected_period) - INTERVAL '1 month'\n    END AS start_date,\n    CASE '${time_window}'\n      WHEN 'ytd'          THEN DATE_TRUNC('year', (SELECT month_date FROM selected_period)) - INTERVAL '1 day'\n      WHEN 'trailing_12m' THEN (SELECT month_date FROM selected_period) - INTERVAL '12 months'\n      ELSE                     (SELECT month_date FROM selected_period) - INTERVAL '1 month'\n    END AS end_date\n),\ncurrent_budget AS (\n  SELECT COALESCE(SUM(net_cash_flow), 0) AS net_cash_flow\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD')\n        BETWEEN (SELECT start_date FROM window_range)\n        AND     (SELECT end_date   FROM window_range)\n),\nprevious_budget AS (\n  SELECT COALESCE(SUM(net_cash_flow), 0) AS net_cash_flow\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD')\n        BETWEEN (SELECT start_date FROM previous_window_range)\n        AND     (SELECT end_date   FROM previous_window_range)\n),\ncurrent_cf AS (\n  SELECT forecasted_next_month_net_flow\n  FROM reporting.rpt_cash_flow_analysis\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD') = (SELECT end_date FROM window_range)\n),\nprevious_cf AS (\n  SELECT forecasted_next_month_net_flow\n  FROM reporting.rpt_cash_flow_analysis\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD') = (SELECT end_date FROM previous_window_range)\n)\nSELECT 'Net Cash Flow' AS metric,\n       cb.net_cash_flow AS current_value,\n       COALESCE(pb.net_cash_flow, cb.net_cash_flow) AS previous_value,\n       cb.net_cash_flow - COALESCE(pb.net_cash_flow, 0) AS delta_value,\n       CASE\n         WHEN COALESCE(pb.net_cash_flow, 0) = 0 AND COALESCE(cb.net_cash_flow, 0) = 0 THEN 0\n         WHEN COALESCE(pb.net_cash_flow, 0) = 0 THEN NULL\n         ELSE (cb.net_cash_flow - COALESCE(pb.net_cash_flow, 0)) / NULLIF(ABS(pb.net_cash_flow), 0)\n       END AS delta_ratio\nFROM current_budget cb LEFT JOIN previous_budget pb ON TRUE\nUNION ALL\nSELECT 'Forecast (Next Month)' AS metric,\n       ccf.forecasted_next_month_net_flow,\n       COALESCE(pcf.forecasted_next_month_net_flow, ccf.forecasted_next_month_net_flow),\n       ccf.forecasted_next_month_net_flow - COALESCE(pcf.forecasted_next_month_net_flow, 0),\n       CASE\n         WHEN COALESCE(pcf.forecasted_next_month_net_flow, 0) = 0 AND COALESCE(ccf.forecasted_next_month_net_flow, 0) = 0 THEN 0\n         WHEN COALESCE(pcf.forecasted_next_month_net_flow, 0) = 0 THEN NULL\n         ELSE (ccf.forecasted_next_month_net_flow - COALESCE(pcf.forecasted_next_month_net_flow, 0)) / NULLIF(ABS(pcf.forecasted_next_month_net_flow), 0)\n       END\nFROM current_cf ccf LEFT JOIN previous_cf pcf ON TRUE;",
          "refId": "A"
        }
      ],
      "description": "Cash-oriented KPIs with raw values; \u00ce\u201d Ratio shows change vs the previous month."
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "PCC52D03280B7034C"
      },
      "description": "Savings and expense ratios for the selected month. Savings rate values are raw ratios (0\u00e2\u20ac\u201c1) of net cash flow to income across the monthly, 3\u00e2\u20ac\u2018month rolling, and year\u00e2\u20ac\u2018to\u00e2\u20ac\u2018date views. Expense ratio is total outflows divided by inflows; lower numbers signal tighter expense control.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic-by-name"
          },
          "custom": {
            "displayMode": "basic",
            "minVizHeight": 10,
            "minVizWidth": 0,
            "orientation": "horizontal",
            "showUnfilled": true,
            "width": 0.6
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "#8B0000",
                "value": null
              },
              {
                "color": "#CD853F",
                "value": 5
              },
              {
                "color": "#DAA520",
                "value": 10
              },
              {
                "color": "#FFD700",
                "value": 20
              },
              {
                "color": "#32CD32",
                "value": 30
              }
            ]
          },
          "unit": "percent",
          "min": 0,
          "max": 100,
          "links": [
            {
              "title": "View Savings Analysis Details",
              "url": "/d/savings_analysis",
              "targetBlank": true
            },
            {
              "title": "View Expense Performance Details",
              "url": "/d/expense_performance",
              "targetBlank": true
            },
            {
              "title": "View Cash Flow Analysis",
              "url": "/d/cash_flow_analysis",
              "targetBlank": true
            }
          ]
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Savings Rate (Monthly)"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "#FF6B35",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Savings Rate (3M Avg)"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "#F7931E",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Savings Rate (YTD)"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "#FFD23F",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Expense Ratio (%)"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "#66BB6A",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "x": 0,
        "y": 8,
        "w": 12,
        "h": 6
      },
      "id": 3,
      "options": {
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": true
        },
        "showThresholdLabels": true,
        "showThresholdMarkers": true,
        "orientation": "horizontal"
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "PCC52D03280B7034C"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "WITH available_months AS (\n  SELECT budget_year_month,\n         to_date(budget_year_month || '-01', 'YYYY-MM-DD') AS month_date\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE budget_year_month < TO_CHAR(CURRENT_DATE, 'YYYY-MM')\n),\nlatest_period AS (\n  SELECT MAX(month_date) AS month_date\n  FROM available_months\n),\nselected_period AS (\n  SELECT CASE\n           WHEN '${dashboard_period}' = 'Latest' OR coalesce('${dashboard_period}', '') = ''\n             THEN (SELECT month_date FROM latest_period)\n           ELSE to_date('${dashboard_period}' || '-01', 'YYYY-MM-DD')\n         END AS month_date\n),\nselected_key AS (\n  SELECT to_char(month_date, 'YYYY-MM') AS month_key\n  FROM selected_period\n),\nwindow_range AS (\n  SELECT\n    CASE '${time_window}'\n      WHEN 'ytd'          THEN DATE_TRUNC('year', (SELECT month_date FROM selected_period))\n      WHEN 'trailing_12m' THEN (SELECT month_date FROM selected_period) - INTERVAL '11 months'\n      ELSE                     (SELECT month_date FROM selected_period)\n    END AS start_date,\n    (SELECT month_date FROM selected_period) AS end_date\n),\nwindow_budget AS (\n  SELECT\n    COALESCE(SUM(net_cash_flow), 0)   AS total_net_cash_flow,\n    COALESCE(SUM(total_income), 0)    AS total_income,\n    COALESCE(SUM(total_expenses), 0)  AS total_expenses\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD')\n        BETWEEN (SELECT start_date FROM window_range)\n        AND     (SELECT end_date   FROM window_range)\n),\nytd_budget AS (\n  SELECT\n    COALESCE(SUM(net_cash_flow), 0) AS ytd_net,\n    COALESCE(SUM(total_income), 0)  AS ytd_income\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD')\n        BETWEEN DATE_TRUNC('year', (SELECT end_date FROM window_range))\n        AND     (SELECT end_date FROM window_range)\n),\ntrailing_3m AS (\n  SELECT\n    COALESCE(SUM(net_cash_flow), 0) AS t3_net,\n    COALESCE(SUM(total_income), 0)  AS t3_income\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD')\n        BETWEEN (SELECT end_date FROM window_range) - INTERVAL '2 months'\n        AND     (SELECT end_date FROM window_range)\n)\nSELECT 'Savings Rate (Monthly)' AS metric_label,\n       ROUND(CASE WHEN NULLIF(wb.total_income, 0) IS NOT NULL\n                  THEN wb.total_net_cash_flow / wb.total_income * 100 ELSE 0 END, 1) AS value\nFROM window_budget wb\nUNION ALL\nSELECT 'Savings Rate (3M Avg)',\n       ROUND(CASE WHEN NULLIF(t3.t3_income, 0) IS NOT NULL\n                  THEN t3.t3_net / t3.t3_income * 100 ELSE 0 END, 1)\nFROM trailing_3m t3\nUNION ALL\nSELECT 'Savings Rate (YTD)',\n       ROUND(CASE WHEN NULLIF(yb.ytd_income, 0) IS NOT NULL\n                  THEN yb.ytd_net / yb.ytd_income * 100 ELSE 0 END, 1)\nFROM ytd_budget yb\nUNION ALL\nSELECT 'Expense Ratio (%)',\n       ROUND(CASE WHEN NULLIF(wb.total_income, 0) IS NOT NULL\n                  THEN wb.total_expenses / wb.total_income * 100 ELSE 0 END, 1)\nFROM window_budget wb;",
          "refId": "A"
        }
      ],
      "title": "Savings & Expense Performance",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {},
            "indexByName": {
              "metric_label": 0,
              "value": 1
            },
            "renameByName": {}
          }
        },
        {
          "id": "groupBy",
          "options": {
            "fields": {
              "metric_label": {
                "aggregations": [],
                "operation": "groupby"
              },
              "value": {
                "aggregations": [
                  "lastNotNull"
                ],
                "operation": "aggregate"
              }
            }
          }
        }
      ],
      "type": "bargauge"
    },
    {
      "id": 102,
      "title": "Health & Risk KPIs",
      "type": "table",
      "gridPos": {
        "x": 12,
        "y": 8,
        "w": 12,
        "h": 5
      },
      "datasource": {
        "type": "postgres",
        "uid": "PCC52D03280B7034C"
      },
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "PCC52D03280B7034C"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "WITH available_months AS (\n  SELECT budget_year_month,\n         to_date(budget_year_month || '-01', 'YYYY-MM-DD') AS month_date\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE budget_year_month < TO_CHAR(CURRENT_DATE, 'YYYY-MM')\n),\nlatest_period AS (\n  SELECT MAX(month_date) AS month_date\n  FROM available_months\n),\nselected_period AS (\n  SELECT CASE\n           WHEN '${dashboard_period}' = 'Latest' OR coalesce('${dashboard_period}', '') = ''\n             THEN (SELECT month_date FROM latest_period)\n           ELSE to_date('${dashboard_period}' || '-01', 'YYYY-MM-DD')\n         END AS month_date\n),\nwindow_range AS (\n  SELECT\n    CASE '${time_window}'\n      WHEN 'ytd'          THEN DATE_TRUNC('year', (SELECT month_date FROM selected_period))\n      WHEN 'trailing_12m' THEN (SELECT month_date FROM selected_period) - INTERVAL '11 months'\n      ELSE                     (SELECT month_date FROM selected_period)\n    END AS start_date,\n    (SELECT month_date FROM selected_period) AS end_date\n),\nprevious_period AS (\n  SELECT MAX(month_date) AS month_date\n  FROM available_months\n  WHERE month_date < (SELECT month_date FROM selected_period)\n),\ncurrent_nw AS (\n  SELECT net_worth_health_score\n  FROM reporting.rpt_household_net_worth\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD') = (SELECT end_date FROM window_range)\n),\nprevious_nw AS (\n  SELECT net_worth_health_score\n  FROM reporting.rpt_household_net_worth\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD') = (SELECT month_date FROM previous_period)\n),\ncurrent_alerts AS (\n  SELECT COALESCE(COUNT(*) FILTER (WHERE needs_attention_flag), 0) AS accounts_at_risk\n  FROM reporting.rpt_account_performance\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD') = (SELECT end_date FROM window_range)\n),\nprevious_alerts AS (\n  SELECT COALESCE(COUNT(*) FILTER (WHERE needs_attention_flag), 0) AS accounts_at_risk\n  FROM reporting.rpt_account_performance\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD') = (SELECT month_date FROM previous_period)\n)\nSELECT 'Net Worth Health Score' AS metric,\n       cnw.net_worth_health_score AS current_value,\n       COALESCE(pnw.net_worth_health_score, cnw.net_worth_health_score) AS previous_value,\n       cnw.net_worth_health_score - COALESCE(pnw.net_worth_health_score, 0) AS delta_value,\n       CASE WHEN COALESCE(pnw.net_worth_health_score, 0) = 0 THEN NULL\n            ELSE (cnw.net_worth_health_score - COALESCE(pnw.net_worth_health_score, 0)) / NULLIF(ABS(pnw.net_worth_health_score), 0)\n       END AS delta_ratio\nFROM current_nw cnw LEFT JOIN previous_nw pnw ON TRUE\nUNION ALL\nSELECT 'Accounts At Risk' AS metric,\n       ca.accounts_at_risk::double precision,\n       COALESCE(pa.accounts_at_risk, ca.accounts_at_risk)::double precision,\n       (ca.accounts_at_risk - COALESCE(pa.accounts_at_risk, 0))::double precision,\n       CASE WHEN COALESCE(pa.accounts_at_risk, 0) = 0 THEN NULL\n            ELSE (ca.accounts_at_risk - COALESCE(pa.accounts_at_risk, 0))::double precision / NULLIF(ABS(pa.accounts_at_risk)::double precision, 0)\n       END\nFROM current_alerts ca LEFT JOIN previous_alerts pa ON TRUE;",
          "refId": "A"
        }
      ],
      "options": {
        "cellHeight": "sm",
        "showHeader": true
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "left"
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "metric"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Metric"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "current_value"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Current"
              },
              {
                "id": "unit",
                "value": "none"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "previous_value"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Previous"
              },
              {
                "id": "unit",
                "value": "none"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "delta_value"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "\u00ce\u201d"
              },
              {
                "id": "unit",
                "value": "none"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "delta_ratio"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "\u00ce\u201d Ratio"
              },
              {
                "id": "unit",
                "value": "percentunit"
              }
            ]
          }
        ]
      },
      "description": "Score and risk KPIs expressed as raw values; \u00ce\u201d Ratio captures relative change where applicable."
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "PCC52D03280B7034C"
      },
      "description": "Expense Control Score translates your outflow-to-inflow ratio into a 0-100 scale. Scores above 80 mean expenses are \u00e2\u2030\u00a490% of income (strong control). 55\u00e2\u20ac\u201c70 means you\u00e2\u20ac\u2122re spending roughly 100\u00e2\u20ac\u201c110% of income (monitor closely). A 10 indicates expenses exceed 150% of income\u00e2\u20ac\u201dan immediate signal that cash burn is unsustainable.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic-by-name"
          },
          "custom": {
            "displayMode": "basic",
            "minVizHeight": 10,
            "minVizWidth": 0,
            "orientation": "horizontal",
            "showUnfilled": true,
            "width": 0.8
          },
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "#8B0000",
                "value": 0
              },
              {
                "color": "#FF4500",
                "value": 30
              },
              {
                "color": "#FFD700",
                "value": 60
              },
              {
                "color": "#32CD32",
                "value": 80
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Expense Control Score"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "#EE4B6A",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "id": 12,
      "title": "Expense Control Score",
      "type": "bargauge",
      "gridPos": {
        "x": 12,
        "y": 13,
        "w": 12,
        "h": 5
      },
      "options": {
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": true
        },
        "showThresholdLabels": true,
        "showThresholdMarkers": true,
        "orientation": "horizontal"
      },
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {},
            "indexByName": {
              "metric_label": 0,
              "value": 1
            },
            "renameByName": {
              "metric_label": "Metric",
              "value": "Value"
            }
          }
        }
      ],
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "PCC52D03280B7034C"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "WITH available_months AS (\n  SELECT budget_year_month,\n         to_date(budget_year_month || '-01', 'YYYY-MM-DD') AS month_date\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE budget_year_month < TO_CHAR(CURRENT_DATE, 'YYYY-MM')\n),\nlatest_period AS (\n  SELECT MAX(month_date) AS month_date\n  FROM available_months\n),\nselected_period AS (\n  SELECT CASE\n           WHEN '${dashboard_period}' = 'Latest' OR coalesce('${dashboard_period}', '') = ''\n             THEN (SELECT month_date FROM latest_period)\n           ELSE to_date('${dashboard_period}' || '-01', 'YYYY-MM-DD')\n         END AS month_date\n),\nselected_key AS (\n  SELECT to_char(month_date, 'YYYY-MM') AS month_key\n  FROM selected_period\n),\nwindow_range AS (\n  SELECT\n    CASE '${time_window}'\n      WHEN 'ytd'          THEN DATE_TRUNC('year', (SELECT month_date FROM selected_period))\n      WHEN 'trailing_12m' THEN (SELECT month_date FROM selected_period) - INTERVAL '11 months'\n      ELSE                     (SELECT month_date FROM selected_period)\n    END AS start_date,\n    (SELECT month_date FROM selected_period) AS end_date\n),\nwindow_cf AS (\n  SELECT\n    COALESCE(SUM(total_outflows), 0) AS total_outflows,\n    COALESCE(SUM(total_inflows), 0)  AS total_inflows\n  FROM reporting.rpt_cash_flow_analysis\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD')\n        BETWEEN (SELECT start_date FROM window_range)\n        AND     (SELECT end_date   FROM window_range)\n)\nSELECT 'Expense Control Score' AS metric_label,\n       CASE\n         WHEN NULLIF(wcf.total_inflows, 0) IS NULL            THEN 40\n         WHEN wcf.total_outflows / wcf.total_inflows <= 0.80  THEN 95\n         WHEN wcf.total_outflows / wcf.total_inflows <= 0.90  THEN 85\n         WHEN wcf.total_outflows / wcf.total_inflows <= 1.00  THEN 70\n         WHEN wcf.total_outflows / wcf.total_inflows <= 1.10  THEN 55\n         WHEN wcf.total_outflows / wcf.total_inflows <= 1.25  THEN 40\n         WHEN wcf.total_outflows / wcf.total_inflows <= 1.50  THEN 25\n         ELSE 10\n       END AS value\nFROM window_cf wcf;",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "PCC52D03280B7034C"
      },
      "description": "Key monthly financial figures: Income (total monthly earnings), Expenses (total monthly spending), Net Cash Flow (income minus expenses), Monthly Savings (amount saved), Net Worth (total assets minus debts), Liquid Assets (readily available cash/investments).",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "#B7950B",
                "value": null
              }
            ]
          },
          "unit": "currencyUSD",
          "links": [
            {
              "title": "View Monthly Budget Summary",
              "url": "/d/monthly_budget_summary",
              "targetBlank": true
            },
            {
              "title": "View Cash Flow Analysis",
              "url": "/d/cash_flow_analysis",
              "targetBlank": true
            },
            {
              "title": "View Net Worth Details",
              "url": "/d/household_net_worth",
              "targetBlank": true
            }
          ]
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "monthly_income"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Monthly Income"
              },
              {
                "id": "color",
                "value": {
                  "fixedColor": "#32CD32",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "monthly_expenses"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Monthly Expenses"
              },
              {
                "id": "color",
                "value": {
                  "fixedColor": "#DC143C",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "monthly_net_cash_flow"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Net Cash Flow"
              },
              {
                "id": "color",
                "value": {
                  "mode": "thresholds"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "#8B0000",
                      "value": null
                    },
                    {
                      "color": "#FFD700",
                      "value": -1000
                    },
                    {
                      "color": "#32CD32",
                      "value": 0
                    }
                  ]
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "monthly_total_savings"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Monthly Savings"
              },
              {
                "id": "color",
                "value": {
                  "fixedColor": "#4169E1",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "current_net_worth"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Net Worth"
              },
              {
                "id": "color",
                "value": {
                  "mode": "thresholds"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "#8B0000",
                      "value": null
                    },
                    {
                      "color": "#FFD700",
                      "value": -100000
                    },
                    {
                      "color": "#32CD32",
                      "value": 0
                    }
                  ]
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "liquid_assets"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Liquid Assets"
              },
              {
                "id": "color",
                "value": {
                  "fixedColor": "#00CED1",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "x": 0,
        "y": 14,
        "w": 12,
        "h": 7
      },
      "id": 5,
      "options": {
        "colorMode": "background",
        "graphMode": "area",
        "justifyMode": "center",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "PCC52D03280B7034C"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "WITH available_months AS (\n  SELECT budget_year_month,\n         to_date(budget_year_month || '-01', 'YYYY-MM-DD') AS month_date\n  FROM reporting.rpt_cash_flow_analysis\n  WHERE budget_year_month < TO_CHAR(CURRENT_DATE, 'YYYY-MM')\n),\nlatest_period AS (\n  SELECT MAX(month_date) AS month_date\n  FROM available_months\n),\nselected_period AS (\n  SELECT CASE\n           WHEN '${dashboard_period}' = 'Latest' OR coalesce('${dashboard_period}', '') = ''\n             THEN (SELECT month_date FROM latest_period)\n           ELSE to_date('${dashboard_period}' || '-01', 'YYYY-MM-DD')\n         END AS month_date\n),\nselected_key AS (\n  SELECT to_char(month_date, 'YYYY-MM') AS month_key\n  FROM selected_period\n),\nwindow_range AS (\n  SELECT\n    CASE '${time_window}'\n      WHEN 'ytd'          THEN DATE_TRUNC('year', (SELECT month_date FROM selected_period))\n      WHEN 'trailing_12m' THEN (SELECT month_date FROM selected_period) - INTERVAL '11 months'\n      ELSE                     (SELECT month_date FROM selected_period)\n    END AS start_date,\n    (SELECT month_date FROM selected_period) AS end_date\n),\nwindow_cf AS (\n  SELECT\n    COALESCE(SUM(total_inflows), 0)  AS total_inflows,\n    COALESCE(SUM(total_outflows), 0) AS total_outflows,\n    COALESCE(SUM(net_cash_flow), 0)  AS net_cash_flow\n  FROM reporting.rpt_cash_flow_analysis\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD')\n        BETWEEN (SELECT start_date FROM window_range)\n        AND     (SELECT end_date   FROM window_range)\n),\ncurrent_nw AS (\n  SELECT net_worth, liquid_assets\n  FROM reporting.rpt_household_net_worth\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD') = (SELECT end_date FROM window_range)\n)\nSELECT\n  ROUND(COALESCE(wcf.total_inflows,  0), 2) AS monthly_income,\n  ROUND(COALESCE(wcf.total_outflows, 0), 2) AS monthly_expenses,\n  ROUND(COALESCE(wcf.net_cash_flow,  0), 2) AS monthly_net_cash_flow,\n  ROUND(COALESCE(wcf.net_cash_flow,  0), 2) AS monthly_total_savings,\n  ROUND(COALESCE(cnw.net_worth,      0), 2) AS current_net_worth,\n  ROUND(COALESCE(cnw.liquid_assets,  0), 2) AS liquid_assets\nFROM window_cf wcf\nLEFT JOIN current_nw cnw ON TRUE;",
          "refId": "A"
        }
      ],
      "title": "Monthly Financial Snapshot",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "PCC52D03280B7034C"
      },
      "description": "Monthly net cash flow, 3-month rolling average, and next-month forecast through the selected period.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "#8B0000",
                "value": null
              },
              {
                "color": "#FFD700",
                "value": -5000
              },
              {
                "color": "#32CD32",
                "value": 0
              }
            ]
          },
          "unit": "currencyUSD",
          "links": [
            {
              "title": "View Cash Flow Analysis",
              "url": "/d/cash_flow_analysis",
              "targetBlank": true
            },
            {
              "title": "View Monthly Budget Summary",
              "url": "/d/monthly_budget_summary",
              "targetBlank": true
            }
          ],
          "custom": {
            "drawStyle": "line",
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "spanNulls": true
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Net Cash Flow"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "#32CD32",
                  "mode": "fixed"
                }
              },
              {
                "id": "custom.drawStyle",
                "value": "bars"
              },
              {
                "id": "custom.lineWidth",
                "value": 0
              },
              {
                "id": "custom.fillOpacity",
                "value": 80
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "3-Month Avg"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "#4169E1",
                  "mode": "fixed"
                }
              },
              {
                "id": "custom.drawStyle",
                "value": "line"
              },
              {
                "id": "custom.lineWidth",
                "value": 2
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Forecast Next Month"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "#FF6347",
                  "mode": "fixed"
                }
              },
              {
                "id": "custom.drawStyle",
                "value": "line"
              },
              {
                "id": "custom.lineStyle",
                "value": {
                  "dash": [
                    10,
                    10
                  ],
                  "fill": "dash"
                }
              },
              {
                "id": "custom.lineWidth",
                "value": 2
              },
              {
                "id": "custom.fillOpacity",
                "value": 10
              }
            ]
          }
        ]
      },
      "gridPos": {
        "x": 12,
        "y": 18,
        "w": 12,
        "h": 7
      },
      "id": 9,
      "options": {
        "legend": {
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "single"
        },
        "showPoints": "never"
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "PCC52D03280B7034C"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "WITH available_months AS (\n  SELECT budget_year_month,\n         to_date(budget_year_month || '-01', 'YYYY-MM-DD') AS month_date\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE budget_year_month < TO_CHAR(CURRENT_DATE, 'YYYY-MM')\n),\nlatest_period AS (\n  SELECT MAX(month_date) AS month_date\n  FROM available_months\n),\nselected_period AS (\n  SELECT CASE\n           WHEN '${dashboard_period}' = 'Latest' OR coalesce('${dashboard_period}', '') = ''\n             THEN (SELECT month_date FROM latest_period)\n           ELSE to_date('${dashboard_period}' || '-01', 'YYYY-MM-DD')\n         END AS month_date\n),\nselected_key AS (\n  SELECT to_char(month_date, 'YYYY-MM') AS month_key\n  FROM selected_period\n),\nwindow_range AS (\n  SELECT\n    CASE '${time_window}'\n      WHEN 'ytd'          THEN DATE_TRUNC('year', (SELECT month_date FROM selected_period))\n      WHEN 'trailing_12m' THEN (SELECT month_date FROM selected_period) - INTERVAL '11 months'\n      ELSE                     (SELECT month_date FROM selected_period)\n    END AS start_date,\n    (SELECT month_date FROM selected_period) AS end_date\n),\ncash_history AS (\n  SELECT to_date(budget_year_month || '-01', 'YYYY-MM-DD') AS month_date,\n         net_cash_flow\n  FROM reporting.rpt_monthly_budget_summary\n),\ncash_with_avg AS (\n  SELECT month_date,\n         net_cash_flow,\n         AVG(net_cash_flow) OVER (ORDER BY month_date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS avg_3m\n  FROM cash_history\n),\nforecast_history AS (\n  SELECT to_date(budget_year_month || '-01', 'YYYY-MM-DD') + interval '1 month' AS forecast_date,\n         forecasted_next_month_net_flow\n  FROM reporting.rpt_cash_flow_analysis\n),\nlookback_start AS (\n  SELECT CASE '${time_window}'\n    WHEN 'ytd'          THEN DATE_TRUNC('year', (SELECT end_date FROM window_range))\n    WHEN 'trailing_12m' THEN (SELECT end_date FROM window_range) - INTERVAL '11 months'\n    ELSE                     (SELECT end_date FROM window_range) - INTERVAL '11 months'\n  END AS start_date\n),\nwindowed AS (\n  SELECT c.month_date,\n         c.net_cash_flow,\n         c.avg_3m\n  FROM cash_with_avg c\n  WHERE c.month_date >= (SELECT start_date FROM lookback_start)\n    AND c.month_date <= (SELECT end_date FROM window_range)\n),\nforecast_windowed AS (\n  SELECT f.forecast_date,\n         f.forecasted_next_month_net_flow\n  FROM forecast_history f\n  WHERE f.forecast_date >= (SELECT start_date FROM lookback_start)\n    AND f.forecast_date <= (SELECT end_date FROM window_range) + interval '1 month'\n)\nSELECT month_date AS \"time\",\n       net_cash_flow AS \"Net Cash Flow\",\n       avg_3m AS \"3-Month Avg\",\n       NULL::numeric AS \"Forecast Next Month\"\nFROM windowed\nUNION ALL\nSELECT forecast_date AS \"time\",\n       NULL::numeric AS \"Net Cash Flow\",\n       NULL::numeric AS \"3-Month Avg\",\n       forecasted_next_month_net_flow AS \"Forecast Next Month\"\nFROM forecast_windowed\nORDER BY \"time\";",
          "refId": "A"
        }
      ],
      "title": "Cash Flow Trend (12 Months)",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "PCC52D03280B7034C"
      },
      "description": "Breakdown of your financial position: Total Assets (all owned assets), Total Liabilities (all debts), Net Worth (assets minus liabilities), Debt-to-Asset Ratio (debt percentage - lower is better).",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "#B7950B",
                "value": null
              }
            ]
          },
          "unit": "currencyUSD",
          "links": [
            {
              "title": "View Net Worth Details",
              "url": "/d/household_net_worth",
              "targetBlank": true
            },
            {
              "title": "View Account Performance",
              "url": "/d/account_performance_dashboard",
              "targetBlank": true
            }
          ]
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "total_assets"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Total Assets"
              },
              {
                "id": "color",
                "value": {
                  "fixedColor": "#32CD32",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "total_liabilities"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Total Liabilities"
              },
              {
                "id": "color",
                "value": {
                  "fixedColor": "#DC143C",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "current_net_worth"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Net Worth"
              },
              {
                "id": "color",
                "value": {
                  "mode": "thresholds"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "#8B0000",
                      "value": null
                    },
                    {
                      "color": "#FFD700",
                      "value": -100000
                    },
                    {
                      "color": "#32CD32",
                      "value": 0
                    }
                  ]
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "debt_to_asset_ratio_percent"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Debt-to-Asset Ratio"
              },
              {
                "id": "unit",
                "value": "percent"
              },
              {
                "id": "color",
                "value": {
                  "mode": "thresholds"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "#32CD32",
                      "value": null
                    },
                    {
                      "color": "#FFD700",
                      "value": 30
                    },
                    {
                      "color": "#FF4500",
                      "value": 50
                    },
                    {
                      "color": "#8B0000",
                      "value": 80
                    }
                  ]
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "x": 0,
        "y": 21,
        "w": 12,
        "h": 7
      },
      "id": 8,
      "options": {
        "colorMode": "background",
        "graphMode": "area",
        "justifyMode": "center",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "PCC52D03280B7034C"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "WITH available_months AS (\n  SELECT budget_year_month,\n         to_date(budget_year_month || '-01', 'YYYY-MM-DD') AS month_date\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE budget_year_month < TO_CHAR(CURRENT_DATE, 'YYYY-MM')\n),\nlatest_period AS (\n  SELECT MAX(month_date) AS month_date\n  FROM available_months\n),\nselected_period AS (\n  SELECT CASE\n           WHEN '${dashboard_period}' = 'Latest' OR coalesce('${dashboard_period}', '') = ''\n             THEN (SELECT month_date FROM latest_period)\n           ELSE to_date('${dashboard_period}' || '-01', 'YYYY-MM-DD')\n         END AS month_date\n),\nselected_key AS (\n  SELECT to_char(month_date, 'YYYY-MM') AS month_key\n  FROM selected_period\n),\nwindow_range AS (\n  SELECT\n    CASE '${time_window}'\n      WHEN 'ytd'          THEN DATE_TRUNC('year', (SELECT month_date FROM selected_period))\n      WHEN 'trailing_12m' THEN (SELECT month_date FROM selected_period) - INTERVAL '11 months'\n      ELSE                     (SELECT month_date FROM selected_period)\n    END AS start_date,\n    (SELECT month_date FROM selected_period) AS end_date\n),\ncurrent_nw AS (\n  SELECT total_assets, total_liabilities, net_worth, debt_to_asset_ratio\n  FROM reporting.rpt_household_net_worth\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD') = (SELECT end_date FROM window_range)\n)\nSELECT\n  ROUND(total_assets, 2) AS total_assets,\n  ROUND(total_liabilities, 2) AS total_liabilities,\n  ROUND(net_worth, 2) AS current_net_worth,\n  ROUND(debt_to_asset_ratio * 100, 1) AS debt_to_asset_ratio_percent\nFROM current_nw;",
          "refId": "A"
        }
      ],
      "title": "Asset & Liability Snapshot",
      "type": "stat"
    },
    {
      "id": 13,
      "title": "Cash Flow Drivers (Month-over-Month)",
      "type": "barchart",
      "datasource": {
        "type": "postgres",
        "uid": "PCC52D03280B7034C"
      },
      "gridPos": {
        "x": 12,
        "y": 25,
        "w": 12,
        "h": 6
      },
      "options": {
        "orientation": "horizontal",
        "xField": "driver",
        "legend": {
          "displayMode": "hidden",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "single"
        },
        "barWidth": 0.6,
        "groupWidth": 0.7,
        "showValue": "never",
        "stacking": "none"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "value": null,
                "color": "red"
              },
              {
                "value": 0,
                "color": "green"
              }
            ]
          },
          "unit": "currencyUSD",
          "custom": {
            "lineWidth": 1,
            "fillOpacity": 80,
            "axisPlacement": "auto"
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "driver"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Driver"
              },
              {
                "id": "custom.axisPlacement",
                "value": "left"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "delta_amount"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Change ($)"
              },
              {
                "id": "custom.axisPlacement",
                "value": "bottom"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "current_income"
            },
            "properties": [
              {
                "id": "custom.hideFrom",
                "value": {
                  "tooltip": false,
                  "viz": true,
                  "legend": true
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "previous_income"
            },
            "properties": [
              {
                "id": "custom.hideFrom",
                "value": {
                  "tooltip": false,
                  "viz": true,
                  "legend": true
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Net Change"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "mode": "thresholds"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "value": null,
                      "color": "red"
                    },
                    {
                      "value": 0,
                      "color": "blue"
                    }
                  ]
                }
              }
            ]
          }
        ]
      },
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "PCC52D03280B7034C"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "WITH available_months AS (\n  SELECT budget_year_month,\n         to_date(budget_year_month || '-01', 'YYYY-MM-DD') AS month_date\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE budget_year_month < TO_CHAR(CURRENT_DATE, 'YYYY-MM')\n),\nlatest_period AS (\n  SELECT MAX(month_date) AS month_date\n  FROM available_months\n),\nselected_period AS (\n  SELECT CASE\n           WHEN '${dashboard_period}' = 'Latest' OR coalesce('${dashboard_period}', '') = ''\n             THEN (SELECT month_date FROM latest_period)\n           ELSE to_date('${dashboard_period}' || '-01', 'YYYY-MM-DD')\n         END AS month_date\n),\nselected_key AS (\n  SELECT to_char(month_date, 'YYYY-MM') AS month_key\n  FROM selected_period\n),\nwindow_range AS (\n  SELECT\n    CASE '${time_window}'\n      WHEN 'ytd'          THEN DATE_TRUNC('year', (SELECT month_date FROM selected_period))\n      WHEN 'trailing_12m' THEN (SELECT month_date FROM selected_period) - INTERVAL '11 months'\n      ELSE                     (SELECT month_date FROM selected_period)\n    END AS start_date,\n    (SELECT month_date FROM selected_period) AS end_date\n)\nSELECT\n  driver,\n  delta_amount,\n  current_income,\n  previous_income\nFROM reporting.rpt_mom_cash_flow_waterfall\nWHERE budget_year_month = (SELECT month_key FROM selected_key)\nORDER BY sort_order;",
          "refId": "A"
        }
      ],
      "description": "Waterfall showing what drove the month-over-month change in net cash flow: income changes, expense changes, and internal transfers."
    },
    {
      "id": 101,
      "title": "Month-over-Month Rate Changes",
      "type": "table",
      "gridPos": {
        "x": 12,
        "y": 31,
        "w": 12,
        "h": 5
      },
      "datasource": {
        "type": "postgres",
        "uid": "PCC52D03280B7034C"
      },
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "PCC52D03280B7034C"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "WITH available_months AS (\n  SELECT budget_year_month,\n         to_date(budget_year_month || '-01', 'YYYY-MM-DD') AS month_date\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE budget_year_month < TO_CHAR(CURRENT_DATE, 'YYYY-MM')\n),\nlatest_period AS (\n  SELECT MAX(month_date) AS month_date\n  FROM available_months\n),\nselected_period AS (\n  SELECT CASE\n           WHEN '${dashboard_period}' = 'Latest' OR coalesce('${dashboard_period}', '') = ''\n             THEN (SELECT month_date FROM latest_period)\n           ELSE to_date('${dashboard_period}' || '-01', 'YYYY-MM-DD')\n         END AS month_date\n),\nwindow_range AS (\n  SELECT\n    CASE '${time_window}'\n      WHEN 'ytd'          THEN DATE_TRUNC('year', (SELECT month_date FROM selected_period))\n      WHEN 'trailing_12m' THEN (SELECT month_date FROM selected_period) - INTERVAL '11 months'\n      ELSE                     (SELECT month_date FROM selected_period)\n    END AS start_date,\n    (SELECT month_date FROM selected_period) AS end_date\n),\nprevious_period AS (\n  SELECT MAX(month_date) AS month_date\n  FROM available_months\n  WHERE month_date < (SELECT month_date FROM selected_period)\n),\ncurrent_budget AS (\n  SELECT savings_rate_percent\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD') = (SELECT end_date FROM window_range)\n),\nprevious_budget AS (\n  SELECT savings_rate_percent\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD') = (SELECT month_date FROM previous_period)\n),\ncurrent_cf AS (\n  SELECT outflow_to_inflow_ratio\n  FROM reporting.rpt_cash_flow_analysis\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD') = (SELECT end_date FROM window_range)\n),\nprevious_cf AS (\n  SELECT outflow_to_inflow_ratio\n  FROM reporting.rpt_cash_flow_analysis\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD') = (SELECT month_date FROM previous_period)\n)\nSELECT 'Savings Rate' AS metric,\n       cb.savings_rate_percent * 100 AS current_value,\n       COALESCE(pb.savings_rate_percent, cb.savings_rate_percent) * 100 AS previous_value,\n       (cb.savings_rate_percent - COALESCE(pb.savings_rate_percent, 0)) * 100 AS delta_value,\n       CASE\n         WHEN COALESCE(pb.savings_rate_percent, 0) = 0 AND COALESCE(cb.savings_rate_percent, 0) = 0 THEN 0\n         WHEN COALESCE(pb.savings_rate_percent, 0) = 0 THEN NULL\n         ELSE (cb.savings_rate_percent - COALESCE(pb.savings_rate_percent, 0)) / NULLIF(ABS(pb.savings_rate_percent), 0)\n       END AS delta_ratio\nFROM current_budget cb LEFT JOIN previous_budget pb ON TRUE\nUNION ALL\nSELECT 'Expense Ratio' AS metric,\n       ccf.outflow_to_inflow_ratio * 100 AS current_value,\n       COALESCE(pcf.outflow_to_inflow_ratio, ccf.outflow_to_inflow_ratio) * 100 AS previous_value,\n       (ccf.outflow_to_inflow_ratio - COALESCE(pcf.outflow_to_inflow_ratio, 0)) * 100 AS delta_value,\n       CASE\n         WHEN COALESCE(pcf.outflow_to_inflow_ratio, 0) = 0 AND COALESCE(ccf.outflow_to_inflow_ratio, 0) = 0 THEN 0\n         WHEN COALESCE(pcf.outflow_to_inflow_ratio, 0) = 0 THEN NULL\n         ELSE (ccf.outflow_to_inflow_ratio - COALESCE(pcf.outflow_to_inflow_ratio, 0)) / NULLIF(ABS(pcf.outflow_to_inflow_ratio), 0)\n       END AS delta_ratio\nFROM current_cf ccf LEFT JOIN previous_cf pcf ON TRUE;",
          "refId": "A"
        }
      ],
      "options": {
        "cellHeight": "sm",
        "showHeader": true
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "left"
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "metric"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Metric"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "current_value"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Current"
              },
              {
                "id": "unit",
                "value": "percent"
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "red",
                      "value": null
                    },
                    {
                      "color": "yellow",
                      "value": 5
                    },
                    {
                      "color": "green",
                      "value": 10
                    }
                  ]
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "previous_value"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Previous"
              },
              {
                "id": "unit",
                "value": "percent"
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "red",
                      "value": null
                    },
                    {
                      "color": "yellow",
                      "value": 5
                    },
                    {
                      "color": "green",
                      "value": 10
                    }
                  ]
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "delta_value"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "\u00ce\u201d"
              },
              {
                "id": "unit",
                "value": "percent"
              }
            ]
          }
        ]
      },
      "description": "Rate metrics on a 0-100 percent scale. Delta Ratio remains a raw ratio for relative change."
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "PCC52D03280B7034C"
      },
      "description": "AI-generated recommendations and action items",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "#B7950B",
                "value": null
              }
            ]
          },
          "links": [
            {
              "title": "View Full Executive Dashboard",
              "url": "/d/executive_dashboard?var-dashboard_period=${dashboard_period}&var-time_window=${time_window}",
              "targetBlank": true
            }
          ]
        },
        "overrides": []
      },
      "gridPos": {
        "x": 0,
        "y": 36,
        "w": 24,
        "h": 6
      },
      "id": 7,
      "options": {
        "cellHeight": "sm",
        "showHeader": true
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "PCC52D03280B7034C"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "WITH available_months AS (\n  SELECT budget_year_month,\n         to_date(budget_year_month || '-01', 'YYYY-MM-DD') AS month_date\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE budget_year_month < TO_CHAR(CURRENT_DATE, 'YYYY-MM')\n),\nlatest_period AS (\n  SELECT MAX(month_date) AS month_date\n  FROM available_months\n),\nselected_period AS (\n  SELECT CASE\n           WHEN '${dashboard_period}' = 'Latest' OR coalesce('${dashboard_period}', '') = ''\n             THEN (SELECT month_date FROM latest_period)\n           ELSE to_date('${dashboard_period}' || '-01', 'YYYY-MM-DD')\n         END AS month_date\n),\nwindow_range AS (\n  SELECT\n    CASE '${time_window}'\n      WHEN 'ytd'          THEN DATE_TRUNC('year', (SELECT month_date FROM selected_period))\n      WHEN 'trailing_12m' THEN (SELECT month_date FROM selected_period) - INTERVAL '11 months'\n      ELSE                     (SELECT month_date FROM selected_period)\n    END AS start_date,\n    (SELECT month_date FROM selected_period) AS end_date\n),\nexec_view AS (\n  SELECT *\n  FROM reporting.rpt_executive_dashboard\n  WHERE to_date(dashboard_month || '-01', 'YYYY-MM-DD')\n        BETWEEN (SELECT start_date FROM window_range)\n        AND     (SELECT end_date   FROM window_range)\n),\nlatest_exec AS (\n  SELECT *\n  FROM exec_view\n  ORDER BY dashboard_month DESC\n  LIMIT 1\n)\nSELECT COALESCE(le.priority_recommendation, 'No recommendation available for this period.') AS \"Priority Recommendation\",\n       COALESCE(le.accounts_with_issues, 'None flagged') AS \"Accounts Needing Attention\"\nFROM latest_exec le\nUNION ALL\nSELECT 'No recommendation available for this period.' AS \"Priority Recommendation\", 'None flagged' AS \"Accounts Needing Attention\"\nWHERE NOT EXISTS (SELECT 1 FROM latest_exec);",
          "refId": "A"
        }
      ],
      "title": "AI Financial Insights",
      "type": "table"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "PCC52D03280B7034C"
      },
      "description": "Additional performance indicators: Current Savings Tier (performance category), Net Worth Health Score (0-100), Accounts Needing Attention (count of problematic accounts), Cash Flow Status (current trend assessment).",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "left"
          },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "#1E90FF",
                "value": null
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "x": 0,
        "y": 42,
        "w": 24,
        "h": 6
      },
      "id": 10,
      "options": {
        "cellHeight": "sm",
        "showHeader": true
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "PCC52D03280B7034C"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "WITH available_months AS (\n  SELECT budget_year_month,\n         to_date(budget_year_month || '-01', 'YYYY-MM-DD') AS month_date\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE budget_year_month < TO_CHAR(CURRENT_DATE, 'YYYY-MM')\n),\nlatest_period AS (\n  SELECT MAX(month_date) AS month_date\n  FROM available_months\n),\nselected_period AS (\n  SELECT CASE\n           WHEN '${dashboard_period}' = 'Latest' OR coalesce('${dashboard_period}', '') = ''\n             THEN (SELECT month_date FROM latest_period)\n           ELSE to_date('${dashboard_period}' || '-01', 'YYYY-MM-DD')\n         END AS month_date\n),\nselected_key AS (\n  SELECT to_char(month_date, 'YYYY-MM') AS month_key\n  FROM selected_period\n),\nwindow_range AS (\n  SELECT\n    CASE '${time_window}'\n      WHEN 'ytd'          THEN DATE_TRUNC('year', (SELECT month_date FROM selected_period))\n      WHEN 'trailing_12m' THEN (SELECT month_date FROM selected_period) - INTERVAL '11 months'\n      ELSE                     (SELECT month_date FROM selected_period)\n    END AS start_date,\n    (SELECT month_date FROM selected_period) AS end_date\n),\ncurrent_cf AS (\n  SELECT cash_flow_status\n  FROM reporting.rpt_cash_flow_analysis\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD') = (SELECT end_date FROM window_range)\n),\ncurrent_nw AS (\n  SELECT wealth_milestone\n  FROM reporting.rpt_household_net_worth\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD') = (SELECT end_date FROM window_range)\n),\naccount_alerts AS (\n  SELECT COALESCE(COUNT(*) FILTER (WHERE needs_attention_flag), 0) AS accounts_needing_attention\n  FROM reporting.rpt_account_performance\n  WHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD') = (SELECT end_date FROM window_range)\n),\nexec_view AS (\n  SELECT *\n  FROM reporting.rpt_executive_dashboard\n  WHERE dashboard_month = (SELECT month_key FROM selected_key)\n)\nSELECT 'Overall Rating' AS metric, COALESCE(ev.overall_financial_health_rating, 'n/a') AS status, 'Composite of savings, cash flow, and net worth signals.' AS detail\nFROM exec_view ev\nUNION ALL\nSELECT 'Savings Tier', COALESCE(ev.current_savings_tier, 'n/a'), 'Benchmark category for latest savings rate.'\nFROM exec_view ev\nUNION ALL\nSELECT 'Cash Flow Status', COALESCE(ccf.cash_flow_status, 'n/a'), 'Health of current month cash flow vs historical pattern.'\nFROM current_cf ccf\nUNION ALL\nSELECT 'Net Worth Phase', COALESCE(cnw.wealth_milestone, 'n/a'), 'Stage of wealth-building progress based on assets and liabilities.'\nFROM current_nw cnw\nUNION ALL\nSELECT 'Accounts Requiring Attention', COALESCE(CAST(aa.accounts_needing_attention AS TEXT), '0'), 'Number of accounts flagged for manual review.'\nFROM account_alerts aa;",
          "refId": "A"
        }
      ],
      "title": "Status Highlights",
      "transformations": [],
      "type": "table"
    },
    {
      "datasource": {
        "type": "text"
      },
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "x": 0,
        "y": 48,
        "w": 24,
        "h": 5
      },
      "id": 100,
      "options": {
        "content": "### How to Read\n- Use the month selector to compare any historical period; \"Latest\" always reflects the newest closed month.\n- Time windows: Latest = most recent complete month; trend panels show trailing 12 months; rolling averages use last 3 complete months.\n- Rates are returned as true ratios (0\u00e2\u20ac\u201c1); keep formatting adjustments in Grafana rather than multiplying by 100 in SQL.\n- Start with low scores or large negative deltas, then drill into linked dashboards for root-cause detail.\n- Forecasts are forward-looking cash expectations; plan around the trajectory, not a single month.",
        "mode": "markdown"
      },
      "pluginVersion": "10.0.0",
      "title": "How to Read This Dashboard",
      "type": "text"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "PCC52D03280B7034C"
      },
      "description": "Quick view of data-quality blockers for the selected period.",
      "fieldConfig": {
        "defaults": {
          "custom": {
            "align": "left"
          },
          "links": [
            {
              "title": "View Outflows Reconciliation Exceptions",
              "url": "/d/outflows_reconciliation?var-dashboard_period=${dashboard_period}&var-time_window=${time_window}",
              "targetBlank": true
            }
          ]
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "value"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 140
              },
              {
                "id": "unit",
                "value": "percent"
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "green",
                      "value": null
                    },
                    {
                      "color": "yellow",
                      "value": 10
                    },
                    {
                      "color": "red",
                      "value": 15
                    }
                  ]
                }
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "type": "color-background"
                }
              },
              {
                "id": "links",
                "value": [
                  {
                    "title": "View Uncategorized Transactions",
                    "url": "/d/transaction_analysis_dashboard?var_category=Uncategorized&var-dashboard_period=${dashboard_period}&var-time_window=${time_window}",
                    "targetBlank": true
                  }
                ]
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "detail"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 240
              }
            ]
          }
        ]
      },
      "gridPos": {
        "x": 0,
        "y": 53,
        "w": 12,
        "h": 6
      },
      "id": 901,
      "options": {
        "cellHeight": "sm",
        "showHeader": true
      },
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "PCC52D03280B7034C"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "WITH available_months AS (\n  SELECT budget_year_month,\n         to_date(budget_year_month || '-01', 'YYYY-MM-DD') AS month_date\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE budget_year_month < TO_CHAR(CURRENT_DATE, 'YYYY-MM')\n),\nlatest_period AS (\n  SELECT MAX(month_date) AS month_date\n  FROM available_months\n),\nselected_period AS (\n  SELECT CASE\n           WHEN '${dashboard_period}' = 'Latest' OR coalesce('${dashboard_period}', '') = ''\n             THEN (SELECT month_date FROM latest_period)\n           ELSE to_date('${dashboard_period}' || '-01', 'YYYY-MM-DD')\n         END AS month_date\n),\nwindow_range AS (\n  SELECT\n    CASE '${time_window}'\n      WHEN 'ytd'          THEN DATE_TRUNC('year', (SELECT month_date FROM selected_period))\n      WHEN 'trailing_12m' THEN (SELECT month_date FROM selected_period) - INTERVAL '11 months'\n      ELSE                     (SELECT month_date FROM selected_period)\n    END AS start_date,\n    (SELECT month_date FROM selected_period) AS end_date\n),\nperiod_bounds AS (\n  SELECT (SELECT start_date FROM window_range) AS window_start,\n         (SELECT end_date   FROM window_range) AS window_end,\n         ((SELECT end_date FROM window_range) + INTERVAL '1 month' - INTERVAL '1 day')::date AS window_end_day\n),\nstale_accounts AS (\n  SELECT COUNT(*) AS stale_accounts\n  FROM reporting.dim_accounts_enhanced\n  WHERE account_last_transaction_date < (SELECT window_end_day FROM period_bounds) - INTERVAL '45 days'\n),\ntransfer_pairs AS (\n  SELECT\n    transaction_date::date AS txn_date,\n    transaction_amount_abs AS amount_abs,\n    SUM(CASE WHEN transaction_amount < 0 THEN 1 ELSE 0 END) AS out_count,\n    SUM(CASE WHEN transaction_amount > 0 THEN 1 ELSE 0 END) AS in_count\n  FROM reporting.fct_transactions_enhanced\n  WHERE COALESCE(is_internal_transfer, FALSE)\n    AND transaction_date >= (SELECT window_start FROM period_bounds)\n    AND transaction_date <= (SELECT window_end_day FROM period_bounds)\n  GROUP BY 1,2\n),\nunmatched_transfers AS (\n  SELECT COALESCE(SUM(ABS(out_count - in_count)), 0) AS unmatched_count\n  FROM transfer_pairs\n),\nuncategorized AS (\n  SELECT\n    COALESCE(SUM(uncategorized_amount), 0) AS uncategorized_amount,\n    CASE\n      WHEN COALESCE(SUM(total_outflows), 0) > 0\n      THEN (COALESCE(SUM(uncategorized_amount), 0) / SUM(total_outflows)) * 100\n      ELSE 0\n    END AS uncategorized_pct\n  FROM reporting.rpt_outflows_insights_dashboard\n  WHERE period_date BETWEEN (SELECT window_start FROM period_bounds)\n                        AND (SELECT window_end   FROM period_bounds)\n)\nSELECT 'Stale accounts (45d+ no activity)' AS metric,\n       COALESCE((SELECT stale_accounts FROM stale_accounts), 0)::text AS value,\n       'Accounts without recent transactions' AS detail\nUNION ALL\nSELECT 'Unmatched internal transfers',\n       COALESCE((SELECT unmatched_count FROM unmatched_transfers), 0)::text,\n       'Proxy count based on paired in/out amounts'\nUNION ALL\nSELECT 'Uncategorized spend',\n       ROUND(COALESCE((SELECT uncategorized_pct FROM uncategorized), 0), 1)::text,\n       CONCAT('$', ROUND(COALESCE((SELECT uncategorized_amount FROM uncategorized), 0), 0)::text, ' uncategorized');",
          "refId": "A"
        }
      ],
      "title": "Data Quality Callouts",
      "type": "table"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "PCC52D03280B7034C"
      },
      "description": "Top uncategorized merchants in the selected dashboard window.",
      "fieldConfig": {
        "defaults": {
          "custom": {
            "align": "left"
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Total Spend"
            },
            "properties": [
              {
                "id": "unit",
                "value": "currencyUSD"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Last Seen"
            },
            "properties": [
              {
                "id": "unit",
                "value": "time: YYYY-MM-DD"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Contribution %"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percent"
              },
              {
                "id": "decimals",
                "value": 2
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Merchant"
            },
            "properties": [
              {
                "id": "links",
                "value": [
                  {
                    "title": "Categorize Merchant",
                    "url": "/d/transaction_analysis_dashboard?var_category=Uncategorized&var-dashboard_period=${dashboard_period}&var-time_window=${time_window}",
                    "targetBlank": true
                  }
                ]
              }
            ]
          }
        ]
      },
      "gridPos": {
        "x": 12,
        "y": 53,
        "w": 12,
        "h": 6
      },
      "id": 902,
      "options": {
        "cellHeight": "sm",
        "showHeader": true
      },
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "PCC52D03280B7034C"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "WITH available_months AS (\n  SELECT budget_year_month,\n         to_date(budget_year_month || '-01', 'YYYY-MM-DD') AS month_date\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE budget_year_month < TO_CHAR(CURRENT_DATE, 'YYYY-MM')\n),\nlatest_period AS (\n  SELECT MAX(month_date) AS month_date\n  FROM available_months\n),\nselected_period AS (\n  SELECT CASE\n           WHEN '${dashboard_period}' = 'Latest' OR coalesce('${dashboard_period}', '') = ''\n             THEN (SELECT month_date FROM latest_period)\n           ELSE to_date('${dashboard_period}' || '-01', 'YYYY-MM-DD')\n         END AS month_date\n),\nwindow_range AS (\n  SELECT\n    CASE '${time_window}'\n      WHEN 'ytd'          THEN DATE_TRUNC('year', (SELECT month_date FROM selected_period))\n      WHEN 'trailing_12m' THEN (SELECT month_date FROM selected_period) - INTERVAL '11 months'\n      ELSE                     (SELECT month_date FROM selected_period)\n    END AS start_date,\n    (SELECT month_date FROM selected_period) AS end_date\n),\nwindow_end_day AS (\n  SELECT ((SELECT end_date FROM window_range) + INTERVAL '1 month' - INTERVAL '1 day')::date AS last_day\n),\nfiltered AS (\n  SELECT\n    original_memo,\n    txn_count,\n    total_amount,\n    last_transaction_date,\n    priority_level\n  FROM reporting.viz_uncategorized_transactions_with_original_memo\n  WHERE last_transaction_date >= (SELECT start_date FROM window_range)\n    AND last_transaction_date <= (SELECT last_day FROM window_end_day)\n),\ntotal_in_window AS (\n  SELECT COALESCE(SUM(total_amount), 0) AS window_total\n  FROM filtered\n),\nranked AS (\n  SELECT\n    original_memo AS \"Merchant\",\n    txn_count AS \"Txn Count\",\n    ROUND(total_amount, 2) AS \"Total Spend\",\n    ROUND(CASE WHEN tw.window_total > 0 THEN (f.total_amount / tw.window_total) * 100 ELSE 0 END, 2) AS \"Contribution %\",\n    last_transaction_date AS \"Last Seen\",\n    priority_level AS \"Priority\"\n  FROM filtered f\n  CROSS JOIN total_in_window tw\n  ORDER BY 4 DESC, f.total_amount DESC\n  LIMIT 10\n)\nSELECT * FROM ranked\nUNION ALL\nSELECT 'None', 0, 0, 0, NULL::date, 'N/A'\nWHERE NOT EXISTS (SELECT 1 FROM ranked);",
          "refId": "A"
        }
      ],
      "title": "Top Uncategorized Merchants",
      "type": "table"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "PCC52D03280B7034C"
      },
      "description": "Monthly spending on family essentials: Groceries, Family & Kids, Health, Household",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "currencyUSD"
        },
        "overrides": []
      },
      "gridPos": {
        "x": 0,
        "y": 59,
        "w": 12,
        "h": 4
      },
      "id": 1001,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "horizontal",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "Total Essentials",
          "values": true
        },
        "textMode": "auto"
      },
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "PCC52D03280B7034C"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "WITH available_months AS (\n  SELECT budget_year_month,\n         to_date(budget_year_month || '-01', 'YYYY-MM-DD') AS month_date\n  FROM reporting.rpt_family_essentials\n  WHERE budget_year_month < TO_CHAR(CURRENT_DATE, 'YYYY-MM')\n),\nlatest_period AS (\n  SELECT MAX(month_date) AS month_date\n  FROM available_months\n),\nselected_period AS (\n  SELECT CASE\n           WHEN '${dashboard_period}' = 'Latest' OR coalesce('${dashboard_period}', '') = ''\n             THEN (SELECT month_date FROM latest_period)\n           ELSE to_date('${dashboard_period}' || '-01', 'YYYY-MM-DD')\n         END AS month_date\n),\nselected_key AS (\n  SELECT to_char(month_date, 'YYYY-MM') AS month_key\n  FROM selected_period\n),\nwindow_range AS (\n  SELECT\n    CASE '${time_window}'\n      WHEN 'ytd'          THEN DATE_TRUNC('year', (SELECT month_date FROM selected_period))\n      WHEN 'trailing_12m' THEN (SELECT month_date FROM selected_period) - INTERVAL '11 months'\n      ELSE                     (SELECT month_date FROM selected_period)\n    END AS start_date,\n    (SELECT month_date FROM selected_period) AS end_date\n)\nSELECT\n  COALESCE(SUM(groceries_spending), 0)         AS \"Groceries\",\n  COALESCE(SUM(family_kids_spending), 0)       AS \"Family & Kids\",\n  COALESCE(SUM(health_spending), 0)            AS \"Health\",\n  COALESCE(SUM(household_spending), 0)         AS \"Household\",\n  COALESCE(SUM(total_family_essentials), 0)    AS \"Total Essentials\"\nFROM reporting.rpt_family_essentials\nWHERE to_date(budget_year_month || '-01', 'YYYY-MM-DD')\n      BETWEEN (SELECT start_date FROM window_range)\n      AND     (SELECT end_date   FROM window_range);",
          "refId": "A"
        }
      ],
      "title": "Family Essentials (Last Month)",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "PCC52D03280B7034C"
      },
      "description": "Months of essential expenses covered by liquid assets. Target: 3-6 months for families with young children.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "max": 6,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": null
              },
              {
                "color": "orange",
                "value": 1
              },
              {
                "color": "yellow",
                "value": 3
              },
              {
                "color": "green",
                "value": 6
              }
            ]
          },
          "unit": "month"
        },
        "overrides": []
      },
      "gridPos": {
        "x": 12,
        "y": 59,
        "w": 6,
        "h": 4
      },
      "id": 1002,
      "options": {
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showThresholdLabels": true,
        "showThresholdMarkers": true
      },
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "PCC52D03280B7034C"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT\n  months_essential_expenses_covered AS \"Months Covered\",\n  coverage_status AS \"Status\"\nFROM reporting.rpt_emergency_fund_coverage\nLIMIT 1;",
          "refId": "A"
        }
      ],
      "title": "Emergency Fund Coverage",
      "type": "gauge"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "PCC52D03280B7034C"
      },
      "description": "Current week spending vs weekly budget target. Shows daily budget remaining for the rest of the week.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "yellow",
                "value": 90
              },
              {
                "color": "red",
                "value": 110
              }
            ]
          },
          "unit": "none"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Pace %"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percent"
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "green",
                      "value": null
                    },
                    {
                      "color": "yellow",
                      "value": 90
                    },
                    {
                      "color": "red",
                      "value": 110
                    }
                  ]
                }
              },
              {
                "id": "decimals",
                "value": 1
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Month Spent"
            },
            "properties": [
              {
                "id": "unit",
                "value": "currencyUSD"
              },
              {
                "id": "decimals",
                "value": 0
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Monthly Budget"
            },
            "properties": [
              {
                "id": "unit",
                "value": "currencyUSD"
              },
              {
                "id": "decimals",
                "value": 0
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Daily Budget Left"
            },
            "properties": [
              {
                "id": "unit",
                "value": "currencyUSD"
              },
              {
                "id": "decimals",
                "value": 0
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Days Left"
            },
            "properties": [
              {
                "id": "unit",
                "value": "short"
              },
              {
                "id": "decimals",
                "value": 0
              }
            ]
          }
        ]
      },
      "gridPos": {
        "x": 18,
        "y": 59,
        "w": 6,
        "h": 4
      },
      "id": 1003,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "horizontal",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": true
        },
        "textMode": "auto"
      },
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "PCC52D03280B7034C"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT\n  mtd_pace_ratio AS \"Pace %\",\n  mtd_spending AS \"Month Spent\",\n  monthly_budget_target AS \"Monthly Budget\",\n  mtd_daily_budget_remaining AS \"Daily Budget Left\",\n  days_remaining_in_month AS \"Days Left\"\nFROM reporting.rpt_weekly_spending_pace\nLIMIT 1;",
          "refId": "A"
        }
      ],
      "title": "Month-to-Date Spending Pace",
      "type": "stat"
    }
  ],
  "refresh": "",
  "schemaVersion": 39,
  "style": "dark",
  "tags": [
    "executive",
    "overview",
    "personal-finance",
    "dashboard"
  ],
  "templating": {
    "list": [
      {
        "name": "time_window",
        "label": "Time Window",
        "type": "custom",
        "hide": 0,
        "current": {
          "text": "Latest Month",
          "value": "latest_month",
          "selected": true
        },
        "options": [
          {
            "text": "Latest Month",
            "value": "latest_month",
            "selected": true
          },
          {
            "text": "Year to Date",
            "value": "ytd",
            "selected": false
          },
          {
            "text": "Trailing 12 Months",
            "value": "trailing_12m",
            "selected": false
          }
        ],
        "query": "latest_month,ytd,trailing_12m",
        "includeAll": false,
        "multi": false,
        "skipUrlSync": false,
        "allowCustom": false
      },
      {
        "name": "dashboard_period",
        "label": "Month",
        "type": "query",
        "hide": 0,
        "datasource": {
          "type": "postgres",
          "uid": "PCC52D03280B7034C"
        },
        "definition": "SELECT month_key FROM (\n  SELECT 'Latest' AS month_key, 0 AS sort_order\n  UNION ALL\n  SELECT DISTINCT budget_year_month AS month_key, 1 AS sort_order\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE budget_year_month < TO_CHAR(CURRENT_DATE, 'YYYY-MM')\n) ordered\nORDER BY sort_order, month_key DESC;",
        "query": "SELECT month_key FROM (\n  SELECT 'Latest' AS month_key, 0 AS sort_order\n  UNION ALL\n  SELECT DISTINCT budget_year_month AS month_key, 1 AS sort_order\n  FROM reporting.rpt_monthly_budget_summary\n  WHERE budget_year_month < TO_CHAR(CURRENT_DATE, 'YYYY-MM')\n) ordered\nORDER BY sort_order, month_key DESC;",
        "refresh": 1,
        "sort": 1,
        "current": {
          "text": "Latest",
          "value": "Latest",
          "selected": true
        },
        "options": [],
        "includeAll": false,
        "multi": false,
        "regex": "",
        "skipUrlSync": false,
        "allowCustom": false
      }
    ]
  },
  "time": {
    "from": "now-1M/M",
    "to": "now/M"
  },
  "timepicker": {
    "hidden": true,
    "quick_ranges": [
      {
        "from": "now-1M/M",
        "to": "now/M",
        "display": "Last complete month"
      },
      {
        "from": "now/Y",
        "to": "now",
        "display": "Year to date"
      },
      {
        "from": "now-12M/M",
        "to": "now/M",
        "display": "Trailing 12 months"
      }
    ]
  },
  "timezone": "",
  "title": "Executive Financial Overview (Most Recent Complete Month)",
  "uid": "executive_dashboard",
  "version": 2,
  "weekStart": ""
}
