{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "id": null,
  "links": [],
  "panels": [
    {
      "datasource": {
        "type": "grafana-postgresql-datasource",
        "uid": "PCC52D03280B7034C"
      },
      "fieldConfig": {
        "defaults": {
          "custom": {
            "align": "center"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": { "h": 3, "w": 24, "x": 0, "y": 0 },
      "id": 103,
      "options": {
        "cellHeight": "sm",
        "footer": { "show": false },
        "showHeader": true
      },
      "targets": [
        {
          "datasource": {
            "type": "grafana-postgresql-datasource",
            "uid": "PCC52D03280B7034C"
          },
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT\n  MAX(budget_year_month) AS \"Data Through\",\n  to_char(MAX(report_generated_at) AT TIME ZONE 'Australia/Melbourne', 'YYYY-MM-DD HH24:MI') AS \"Last Refresh\",\n  'Monthly cadence' AS \"Expected Cadence\"\nFROM reporting.rpt_monthly_budget_summary;",
          "refId": "A"
        }
      ],
      "title": "Data Freshness",
      "type": "table"
    },
    {
      "datasource": {
        "type": "grafana-postgresql-datasource",
        "uid": "PCC52D03280B7034C"
      },
      "gridPos": { "h": 3, "w": 24, "x": 0, "y": 3 },
      "id": 100,
      "options": {
        "content": "## Executive Overview\n\nKey financial metrics and health indicators at a glance. Panels show the latest closed month.",
        "mode": "markdown"
      },
      "title": "Dashboard Guide",
      "type": "text"
    },
    {
      "datasource": {
        "type": "grafana-postgresql-datasource",
        "uid": "PCC52D03280B7034C"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "red",    "value": null },
              { "color": "yellow", "value": 60 },
              { "color": "green",  "value": 80 }
            ]
          },
          "unit": "percent",
          "min": 0,
          "max": 100
        },
        "overrides": []
      },
      "gridPos": { "h": 6, "w": 8, "x": 0, "y": 6 },
      "id": 1,
      "options": {
        "orientation": "horizontal",
        "reduceOptions": {
          "values": true,
          "calcs": ["lastNotNull"],
          "fields": ""
        },
        "showThresholdLabels": false,
        "showThresholdMarkers": true
      },
      "targets": [
        {
          "datasource": {
            "type": "grafana-postgresql-datasource",
            "uid": "PCC52D03280B7034C"
          },
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT\n  GREATEST(0, LEAST(100, ROUND((1 - expense_ratio_percent) * 100, 0))) AS \"Expense Control\",\n  GREATEST(0, LEAST(100, ROUND(savings_rate_pct, 0))) AS \"Savings Rate\",\n  CASE WHEN net_cash_flow >= 0 THEN 75 ELSE GREATEST(0, LEAST(100, ROUND(50 + savings_rate_pct, 0))) END AS \"Cash Flow\"\nFROM reporting.rpt_monthly_budget_summary\nWHERE budget_year_month = (SELECT MAX(budget_year_month) FROM reporting.rpt_monthly_budget_summary);",
          "refId": "A"
        }
      ],
      "title": "Health Scores",
      "type": "bargauge"
    },
    {
      "datasource": {
        "type": "grafana-postgresql-datasource",
        "uid": "PCC52D03280B7034C"
      },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "align": "center",
            "cellOptions": { "type": "auto" },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [{ "color": "green", "value": null }]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "Savings %" },
            "properties": [{ "id": "unit", "value": "percent" }]
          },
          {
            "matcher": { "id": "byName", "options": "Net Flow" },
            "properties": [
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    { "color": "red",   "value": null },
                    { "color": "green", "value": 0 }
                  ]
                }
              },
              { "id": "custom.cellOptions", "value": { "type": "color-background" } }
            ]
          }
        ]
      },
      "gridPos": { "h": 6, "w": 16, "x": 8, "y": 6 },
      "id": 2,
      "options": {
        "cellHeight": "sm",
        "footer": { "show": false },
        "showHeader": true
      },
      "targets": [
        {
          "datasource": {
            "type": "grafana-postgresql-datasource",
            "uid": "PCC52D03280B7034C"
          },
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT\n  ROUND(total_income, 0) AS \"Income\",\n  ROUND(total_expenses, 0) AS \"Expenses\",\n  ROUND(net_cash_flow, 0) AS \"Net Flow\",\n  ROUND(savings_rate_pct, 1) AS \"Savings %\"\nFROM reporting.rpt_monthly_budget_summary\nWHERE budget_year_month = (SELECT MAX(budget_year_month) FROM reporting.rpt_monthly_budget_summary);",
          "refId": "A"
        }
      ],
      "title": "Key Metrics",
      "type": "table"
    },
    {
      "datasource": {
        "type": "grafana-postgresql-datasource",
        "uid": "PCC52D03280B7034C"
      },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "vis": false },
            "lineInterpolation": "linear",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [{ "color": "green", "value": null }]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 24, "x": 0, "y": 12 },
      "id": 3,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": { "mode": "multi", "sort": "none" }
      },
      "targets": [
        {
          "datasource": {
            "type": "grafana-postgresql-datasource",
            "uid": "PCC52D03280B7034C"
          },
          "format": "time_series",
          "rawQuery": true,
          "rawSql": "SELECT\n  TO_TIMESTAMP(budget_year_month || '-01', 'YYYY-MM-DD')::date AS time,\n  ROUND(total_income, 0) AS \"Income\",\n  ROUND(total_expenses, 0) AS \"Expenses\",\n  ROUND(net_cash_flow, 0) AS \"Net Cash Flow\"\nFROM reporting.rpt_monthly_budget_summary\nWHERE budget_year_month >= TO_CHAR($__timeTo()::date - INTERVAL '12 months', 'YYYY-MM')\n  AND budget_year_month < TO_CHAR($__timeTo()::date, 'YYYY-MM')\nORDER BY budget_year_month;",
          "refId": "A"
        }
      ],
      "title": "12-Month Cash Flow Trend",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "grafana-postgresql-datasource",
        "uid": "PCC52D03280B7034C"
      },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "align": "center",
            "cellOptions": { "type": "auto" },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [{ "color": "green", "value": null }]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 7, "w": 12, "x": 0, "y": 20 },
      "id": 4,
      "options": {
        "cellHeight": "sm",
        "footer": { "show": false },
        "showHeader": true
      },
      "targets": [
        {
          "datasource": {
            "type": "grafana-postgresql-datasource",
            "uid": "PCC52D03280B7034C"
          },
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT\n  account_type AS \"Account Type\",\n  ROUND(SUM(end_of_month_balance), 0) AS \"Balance\"\nFROM reporting.rpt_account_performance\nWHERE budget_year_month = (SELECT MAX(budget_year_month) FROM reporting.rpt_account_performance)\nGROUP BY account_type\nORDER BY SUM(end_of_month_balance) DESC;",
          "refId": "A"
        }
      ],
      "title": "Account Balances",
      "type": "table"
    },
    {
      "datasource": {
        "type": "grafana-postgresql-datasource",
        "uid": "PCC52D03280B7034C"
      },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "align": "center",
            "cellOptions": { "type": "auto" },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [{ "color": "green", "value": null }]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 7, "w": 12, "x": 12, "y": 20 },
      "id": 5,
      "options": {
        "cellHeight": "sm",
        "footer": { "show": false },
        "showHeader": true
      },
      "targets": [
        {
          "datasource": {
            "type": "grafana-postgresql-datasource",
            "uid": "PCC52D03280B7034C"
          },
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT\n  level_1_category AS \"Category\",\n  ROUND(monthly_spending, 0) AS \"Amount\"\nFROM reporting.rpt_category_spending_trends\nWHERE budget_year_month = (SELECT MAX(budget_year_month) FROM reporting.rpt_category_spending_trends)\n  AND monthly_spending > 0\nORDER BY monthly_spending DESC\nLIMIT 5;",
          "refId": "A"
        }
      ],
      "title": "Top Spending",
      "type": "table"
    },
    {
      "datasource": {
        "type": "grafana-postgresql-datasource",
        "uid": "PCC52D03280B7034C"
      },
      "gridPos": { "h": 3, "w": 24, "x": 0, "y": 27 },
      "id": 102,
      "options": {
        "content": "## Data Quality & Reconciliation\n\nFinancial data validation and reconciliation status across all reporting domains.",
        "mode": "markdown"
      },
      "title": "Reconciliation Status",
      "type": "text"
    },
    {
      "datasource": {
        "type": "grafana-postgresql-datasource",
        "uid": "PCC52D03280B7034C"
      },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "red",   "value": 1 }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 8, "x": 0, "y": 30 },
      "id": 6,
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "horizontal",
        "reduceOptions": {
          "values": false,
          "calcs": ["lastNotNull"],
          "fields": "/^failed$/"
        },
        "textMode": "value"
      },
      "targets": [
        {
          "datasource": {
            "type": "grafana-postgresql-datasource",
            "uid": "PCC52D03280B7034C"
          },
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT failed FROM reporting.rpt_financials_reconciliation_summary ORDER BY period_date DESC LIMIT 1;",
          "refId": "A"
        }
      ],
      "title": "Failed Checks",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-postgresql-datasource",
        "uid": "PCC52D03280B7034C"
      },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "mappings": [
            {
              "options": {
                "ALL_PASS": { "color": "green", "index": 0, "text": "ALL PASS" }
              },
              "type": "value"
            },
            {
              "options": {
                "SOME_FAIL": { "color": "red", "index": 1, "text": "SOME FAIL" }
              },
              "type": "value"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [{ "color": "green", "value": null }]
          }
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 8, "x": 8, "y": 30 },
      "id": 7,
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "horizontal",
        "reduceOptions": {
          "values": false,
          "calcs": ["lastNotNull"],
          "fields": "/^status$/"
        },
        "textMode": "value"
      },
      "targets": [
        {
          "datasource": {
            "type": "grafana-postgresql-datasource",
            "uid": "PCC52D03280B7034C"
          },
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT status FROM reporting.rpt_financials_reconciliation_summary ORDER BY period_date DESC LIMIT 1;",
          "refId": "A"
        }
      ],
      "title": "Overall Status",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-postgresql-datasource",
        "uid": "PCC52D03280B7034C"
      },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "align": "center",
            "cellOptions": { "type": "auto" },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [{ "color": "green", "value": null }]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "failed" },
            "properties": [
              { "id": "color", "value": { "mode": "thresholds" } },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    { "color": "green", "value": null },
                    { "color": "red",   "value": 1 }
                  ]
                }
              }
            ]
          }
        ]
      },
      "gridPos": { "h": 4, "w": 8, "x": 16, "y": 30 },
      "id": 8,
      "options": {
        "cellHeight": "sm",
        "footer": { "show": false },
        "showHeader": true
      },
      "targets": [
        {
          "datasource": {
            "type": "grafana-postgresql-datasource",
            "uid": "PCC52D03280B7034C"
          },
          "format": "table",
          "rawQuery": true,
          "rawSql": "WITH latest AS (\n  SELECT MAX(period_date) AS p FROM reporting.rpt_financials_reconciliation_tests\n)\nSELECT\n  domain,\n  COUNT(*) FILTER (WHERE pass) AS passed,\n  COUNT(*) FILTER (WHERE NOT pass) AS failed,\n  COUNT(*) AS total\nFROM reporting.rpt_financials_reconciliation_tests\nWHERE period_date = (SELECT p FROM latest)\nGROUP BY domain\nORDER BY domain;",
          "refId": "A"
        }
      ],
      "title": "Domain Summary",
      "type": "table"
    },
    {
      "datasource": {
        "type": "grafana-postgresql-datasource",
        "uid": "PCC52D03280B7034C"
      },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "align": "center",
            "cellOptions": { "type": "auto" },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [{ "color": "green", "value": null }]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "confidence" },
            "properties": [{ "id": "unit", "value": "percentunit" }]
          },
          {
            "matcher": { "id": "byName", "options": "amount" },
            "properties": [{ "id": "unit", "value": "short" }]
          }
        ]
      },
      "gridPos": { "h": 6, "w": 24, "x": 0, "y": 34 },
      "id": 9,
      "options": {
        "cellHeight": "sm",
        "footer": { "show": false },
        "showHeader": true
      },
      "targets": [
        {
          "datasource": {
            "type": "grafana-postgresql-datasource",
            "uid": "PCC52D03280B7034C"
          },
          "format": "table",
          "rawQuery": true,
          "rawSql": "WITH data AS (\n  SELECT month, account_name, amount, count, example_transaction, suggested_category, suggested_subcategory, confidence\n  FROM reporting.viz_uncategorized_missing_example_top5\n  ORDER BY amount DESC\n)\nSELECT * FROM data\nUNION ALL\nSELECT 'N/A', 'None', 0, 0, 'No uncategorized transactions'::text, 'N/A', 'N/A', 0\nWHERE NOT EXISTS (SELECT 1 FROM data);",
          "refId": "A"
        }
      ],
      "title": "Top 5 Uncategorized (Need Review)",
      "type": "table"
    }
  ],
  "schemaVersion": 40,
  "tags": ["mobile", "executive", "overview"],
  "templating": { "list": [] },
  "time": { "from": "now-12M", "to": "now" },
  "timepicker": {
    "quick_ranges": [
      { "display": "Last complete month", "from": "now-1M/M", "to": "now/M" },
      { "display": "Last quarter",        "from": "now-3M/M", "to": "now/M" },
      { "display": "Year to date",        "from": "now/y",    "to": "now" },
      { "display": "Trailing 12 months",  "from": "now-12M/M","to": "now/M" }
    ]
  },
  "timezone": "Australia/Melbourne",
  "title": "18 - Executive Overview (Mobile)",
  "uid": "exec-mobile-overview",
  "version": 1,
  "weekStart": ""
}
